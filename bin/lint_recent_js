#!/bin/bash

# Only lint JS modified since 'd-day' (when JS started getting linted)
# As a file gets edited, it's time to fix the lint warnings.
# This allows progressive linting of the previous JS.

set -eu

LINT_SINCE_SHA=33e3c45a
EDITED_JS_FILES=$(git diff $LINT_SINCE_SHA..HEAD --name-only -- '*.js' | grep -Ev 'eslintrc|vendor')

if [[ "$EDITED_JS_FILES" == "" ]]; then
  echo "No JS files to lint"
else
  echo "Linting JS"
  echo "$EDITED_JS_FILES"
  node_modules/.bin/eslint $EDITED_JS_FILES
fi
